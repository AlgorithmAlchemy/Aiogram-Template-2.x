# ü§ñ Aiogram 2.x Template - –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è Telegram –±–æ—Ç–æ–≤ –Ω–∞ aiogram 2.x —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –û–û–ü –ø–æ–¥—Ö–æ–¥–æ–º –∏ –ª—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **üèóÔ∏è –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **üéØ –û–û–ü –ø–æ–¥—Ö–æ–¥** - –≤—Å–µ —Ö—ç–Ω–¥–ª–µ—Ä—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç –±–∞–∑–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤
- **üóÑÔ∏è –£–ª—É—á—à–µ–Ω–Ω–∞—è –ë–î** - —Å–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–π, –∏—Å—Ç–æ—Ä–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏, –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- **üîß Middleware** - –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ, —Å –±–∞–∑–æ–≤—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏
- **üåê API –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API
- **üìù –Ø–≤–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ main.py
- **üöÄ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ main.py                    # üéØ –ì–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ loader.py                  # ‚öôÔ∏è –ë–∞–∑–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ data/                      # üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ models/                    # üóÑÔ∏è –ú–æ–¥–µ–ª–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ base.py               # üì¶ –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ user.py               # üë§ –ú–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ migrations.py         # üîÑ –°–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ sqlite3_creator.py    # üõ†Ô∏è –ú–µ–Ω–µ–¥–∂–µ—Ä –ë–î
‚îú‚îÄ‚îÄ database/                  # üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ connection.py         # ‚ö° –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ api/                       # üåê –í–Ω–µ—à–Ω–∏–µ API
‚îÇ   ‚îú‚îÄ‚îÄ base.py               # üì¶ –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å API
‚îÇ   ‚îú‚îÄ‚îÄ weather.py            # üå§Ô∏è API –ø–æ–≥–æ–¥—ã
‚îÇ   ‚îî‚îÄ‚îÄ currency.py           # üí± API –≤–∞–ª—é—Ç
‚îú‚îÄ‚îÄ handlers/                  # üéÆ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ base_handler.py       # üì¶ –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ users/message/commands/ # üìù –ö–æ–º–∞–Ω–¥—ã
‚îú‚îÄ‚îÄ middleware/                # üîß Middleware
‚îÇ   ‚îú‚îÄ‚îÄ base.py               # üì¶ –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
‚îÇ   ‚îú‚îÄ‚îÄ logging.py            # üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ throttling.py         # ‚è±Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ admin.py              # üëë –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ database.py           # üóÑÔ∏è –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îú‚îÄ‚îÄ utils/                     # üõ†Ô∏è –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ filters/                   # üîç –§–∏–ª—å—Ç—Ä—ã
‚îú‚îÄ‚îÄ states/                    # üéØ FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îú‚îÄ‚îÄ keyboards/                 # ‚å®Ô∏è –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ examples/                  # üìö –ü—Ä–∏–º–µ—Ä—ã
‚îî‚îÄ‚îÄ docs/                      # üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/your-username/aiogram-template.git
cd aiogram-template
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
cp data/config.example.py data/config.py
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config.py —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
```

### 3. –ó–∞–ø—É—Å–∫

```bash
python main.py
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Loader (loader.py)

–ë–∞–∑–æ–≤—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞:

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (Memory/Redis)
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –±–æ—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞

### BotManager (main.py)

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º:

- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ö—ç–Ω–¥–ª–µ—Ä–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ middleware
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–æ–º/–æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π

### –û–û–ü –•—ç–Ω–¥–ª–µ—Ä—ã

–í—Å–µ —Ö—ç–Ω–¥–ª–µ—Ä—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç –±–∞–∑–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤:

```python
class StartCommandHandler(BaseCommandHandler):
    def get_command(self) -> str:
        return "start"

    async def handle(self, message: types.Message):
        await message.answer("–ü—Ä–∏–≤–µ—Ç!")
```

### Middleware

–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ middleware —Å –±–∞–∑–æ–≤—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏:

```python
class LoggingMiddleware(BaseCustomMiddleware):
    async def pre_process(self, event, data):
        logger.info(f"Message from {event.from_user.id}")
```

### API –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API:

```python
async with WeatherAPIWrapper() as api:
    weather = await api.get_weather("Moscow")
```

## üìö –ü—Ä–∏–º–µ—Ä—ã

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ö—ç–Ω–¥–ª–µ—Ä–∞

```python
# handlers/users/message/commands/mycommand.py
from handlers.base_handler import BaseCommandHandler
from aiogram import types


class MyCommandHandler(BaseCommandHandler):
    def get_command(self) -> str:
        return "mycommand"

    async def handle(self, message: types.Message):
        await message.answer("–ú–æ–π —Ö—ç–Ω–¥–ª–µ—Ä!")


# main.py
from handlers.users.message.commands.mycommand import MyCommandHandler

MyCommandHandler(self.dp),
```

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ API

```python
# api/custom.py
from api.base import BaseAPIWrapper


class CustomAPIWrapper(BaseAPIWrapper):
    def __init__(self):
        super().__init__(base_url="https://api.example.com")

    async def make_request(self, method, endpoint, data=None):
        # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
        pass


# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
async with CustomAPIWrapper() as api:
    data = await api.get("endpoint")
```

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏

```python
# models/new_model.py
from models.base import BaseModel
from peewee import CharField

class NewModel(BaseModel):
    name = CharField(max_length=100)
    description = CharField(null=True)
    
    class Meta:
        table_name = 'new_table'
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```python
# data/config.py
BOT_TOKEN = "your_bot_token"
ADMIN_IDS = [123456789]
DEBUG = True

# Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
USE_REDIS = False
REDIS_HOST = "localhost"
REDIS_PORT = 6379
```

### API –∫–ª—é—á–∏

```python
# API –∫–ª—é—á–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
WEATHER_API_KEY = "your_openweathermap_key"
CURRENCY_API_KEY = "your_exchangerate_key"
```

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](docs/ARCHITECTURE.md)
- [üéÆ –ü—Ä–∏–º–µ—Ä—ã —Ö—ç–Ω–¥–ª–µ—Ä–æ–≤](examples/oop_handlers_example.py)
- [üåê –ü—Ä–∏–º–µ—Ä—ã API](examples/api_examples.py)
- [üîß –ü—Ä–∏–º–µ—Ä—ã middleware](examples/middleware_examples.py)
- [üóÑÔ∏è –ü—Ä–∏–º–µ—Ä—ã –ë–î](examples/improved_database_examples.py)

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

1. **–•—ç–Ω–¥–ª–µ—Ä—ã** - –Ω–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –æ—Ç –±–∞–∑–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤
2. **API** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ BaseAPIWrapper
3. **Middleware** - –Ω–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –æ—Ç BaseCustomMiddleware
4. **–ú–æ–¥–µ–ª–∏** - –Ω–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –æ—Ç BaseModel
5. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - –¥–æ–±–∞–≤—å—Ç–µ –≤ main.py

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–æ–≤
python examples/oop_handlers_example.py
python examples/api_examples.py
python examples/middleware_examples.py
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å 1.x

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

1. **–•—ç–Ω–¥–ª–µ—Ä—ã** - –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ø–æ–¥ –û–û–ü –ø–æ–¥—Ö–æ–¥
2. **–ò–º–ø–æ—Ä—Ç—ã** - –æ–±–Ω–æ–≤–∏—Ç—å –ø—É—Ç–∏ –∫ middleware, API, –ë–î
3. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ main.py
4. **–ú–æ–¥–µ–ª–∏** - –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç BaseModel

### –ü–æ—à–∞–≥–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
cp -r your_old_project backup/

# 2. –û–±–Ω–æ–≤–∏—Ç–µ —Ö—ç–Ω–¥–ª–µ—Ä—ã
# –°–º. –ø—Ä–∏–º–µ—Ä—ã –≤ examples/oop_handlers_example.py

# 3. –û–±–Ω–æ–≤–∏—Ç–µ –∏–º–ø–æ—Ä—Ç—ã
# middleware/ –≤–º–µ—Å—Ç–æ utils/middleware/
# api/ –≤–º–µ—Å—Ç–æ utils/api_wrappers/
# database/ –≤–º–µ—Å—Ç–æ utils/db_api/

# 4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≤ main.py
# –°–º. register_handlers() –≤ main.py
```

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork –ø—Ä–æ–µ–∫—Ç–∞
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [aiogram](https://github.com/aiogram/aiogram) - –æ—Ç–ª–∏—á–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Telegram –±–æ—Ç–æ–≤
- [Peewee](https://github.com/coleifer/peewee) - –ª–µ–≥–∫–∏–π ORM
- –°–æ–æ–±—â–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ Telegram –±–æ—Ç–æ–≤

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞e

- üêõ Issues: [GitHub Issues](https://github.com/your-username/aiogram-template/issues)

---

‚≠ê –ï—Å–ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –≤–∞–º –ø–æ–º–æ–≥, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫—É!
